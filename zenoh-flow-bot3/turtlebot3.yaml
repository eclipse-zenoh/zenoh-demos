flow: TB3-Flow


vars:
  UBUNTU_BASE_DIR: TODO
  GABRI_BASE_DIR: TODO


sources:
  - id: Gamepad
    uri: "{{ GABRI_BASE_DIR }}/zenoh-flow-bot3/source-gamepad/src/gamepad.yml"

  - id: Lidar
    uri: "{{ UBUNTU_BASE_DIR }}/zenoh-flow-bot3/source-lidar/src/lidar.yml"
    configuration:
      #serial: /dev/tty.usbmodemFFFFFFFEFFFF1
      serial: /dev/ttyUSB0
      baudrate: 230400

  - id : Tick
    uri: "{{ UBUNTU_BASE_DIR }}/zenoh-flow-bot3/source-tick/src/tick.yml"


operators:
  - id: Twist
    uri: "{{ GABRI_BASE_DIR }}/zenoh-flow-bot3/operator-twist/src/twist.yml"

  - id : TB3
    uri: "{{ UBUNTU_BASE_DIR }}/zenoh-flow-bot3/tb3/src/tb3.yml"
    configuration:
      #serial: /dev/tty.usbmodemFFFFFFFEFFFF1
      serial: /dev/ttyACM0
      baudrate: 115200


sinks:
  - id : RobotSink
    uri: "{{ GABRI_BASE_DIR }}/zenoh-flow-bot3/robot-sink/src/robot-sink.yml"

  - id : LidarSink
    uri: "{{ GABRI_BASE_DIR }}/zenoh-flow-bot3/lidar-sink/src/lidar-sink.yml"


links:
- from:
    node: Gamepad
    output: gamepad-input
  to:
    node: Twist
    input: gamepad-input
- from:
    node: Twist
    output: twist
  to:
    node: TB3
    input: Twist
- from:
    node: Tick
    output: Tick
  to:
    node: TB3
    input: Tick
- from:
    node: TB3
    output: Robot
  to:
    node: RobotSink
    input: Data
- from:
    node: Lidar
    output: Scan
  to:
    node: LidarSink
    input: Data


mapping:
  Lidar: robot
  Gamepad: ws
  Tick: robot
  Twist: ws
  TB3: robot
  RobotSink: ws
  LidarSink: ws
