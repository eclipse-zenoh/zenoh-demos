flow: TB3-Flow
vars:
  ROBOT_BASE_DIR: /home/ubuntu/zf-bot
  WS_BASE_DIR: /Volumes/Workspace/Workspace/zdemos

sources:
  - id: Gamepad
    descriptor: "{{ WS_BASE_DIR }}/zenoh-flow-bot3/source-gamepad/src/gamepad.yml"

  - id: Lidar
    descriptor: "{{ ROBOT_BASE_DIR }}/zenoh-flow-bot3/source-lidar/src/lidar.yml"
    configuration:
      #serial: /dev/tty.usbmodemFFFFFFFEFFFF1
      serial: /dev/ttyUSB0
      baudrate: 230400

  - id : Tick
    descriptor: "{{ ROBOT_BASE_DIR }}/zenoh-flow-bot3/source-tick/src/tick.yml"


operators:
  - id: Twist
    descriptor: "{{ WS_BASE_DIR }}/zenoh-flow-bot3/operator-twist/src/twist.yml"

  - id : TB3
    descriptor: "{{ ROBOT_BASE_DIR }}/zenoh-flow-bot3/tb3/src/tb3.yml"
    configuration:
      #serial: /dev/tty.usbmodemFFFFFFFEFFFF1
      serial: /dev/ttyACM0
      baudrate: 115200


sinks:
  - id : RobotSink
    configuration:
      file: /tmp/robot-data.log
    descriptor: "{{ WS_BASE_DIR }}/zenoh-flow-bot3/robot-sink/src/robot-sink.yml"

  - id : LidarSink
    descriptor: "{{ WS_BASE_DIR }}/zenoh-flow-bot3/lidar-sink/src/lidar-sink.yml"


links:
- from:
    node: Gamepad
    output: gamepad-input
  to:
    node: Twist
    input: gamepad-input
- from:
    node: Twist
    output: twist
  to:
    node: TB3
    input: Twist
- from:
    node: Tick
    output: Tick
  to:
    node: TB3
    input: Tick
- from:
    node: TB3
    output: Robot
  to:
    node: RobotSink
    input: Data
- from:
    node: Lidar
    output: Scan
  to:
    node: LidarSink
    input: Data


mapping:
  Lidar: robot
  Gamepad: ws
  Tick: robot
  Twist: ws
  TB3: robot
  RobotSink: ws
  LidarSink: ws
